import express from 'express'; import cors from 'cors'; import bodyParser from 'body-parser'; import { v4 as uuidv4 } from 'uuid'; const app = express(); app.use(cors()); app.use(bodyParser.json()); const users=[]; const sessions={}; const orders=[]; const loans=[]; const deliveries=[]; app.post('/api/auth/register',(req,res)=>{const {email,password,role='user'}=req.body; if(!email||!password) return res.status(400).send({error:'email & password required'}); const user={id:uuidv4(),email,role,passwordHash:password}; users.push(user); res.send({ok:true,user:{id:user.id,email:user.email,role:user.role}});}); app.post('/api/auth/login',(req,res)=>{const {email,password}=req.body; const u=users.find(x=>x.email===email && x.passwordHash===password); if(!u) return res.status(401).send({error:'Invalid'}); const token=uuidv4(); sessions[token]=u.id; res.send({token,user:{id:u.id,email:u.email,role:u.role}});}); function authMiddleware(req,res,next){const token=req.headers['authorization']?.replace('Bearer ',''); if(!token||!sessions[token]) return res.status(401).send({error:'Unauthorized'}); req.userId=sessions[token]; next(); } app.get('/api/markets',(req,res)=>{res.send([{symbol:'EURUSD',price:1.0789,change:+0.12},{symbol:'XAUUSD',price:1950.12,change:-0.3},{symbol:'OIL',price:82.33,change:+0.45}]);}); app.post('/api/trade/place',authMiddleware,(req,res)=>{const {symbol,side,amount,type,price}=req.body; const order={id:uuidv4(),userId:req.userId,symbol,side,amount,type,price,status:'placed',createdAt:Date.now()}; orders.push(order); res.send({ok:true,order});}); app.listen(4000,()=>console.log('API running on http://localhost:4000'));